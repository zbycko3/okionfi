define((function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var s=e[i]={i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(i,s,function(e){return t[e]}.bind(null,s));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="https://gitlab-runner-s-gr.devel.ppstatic.pl/assets/gratka/v0.0.0/dist/",n(n.s=108)}({108:function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}n.r(e),n.d(e,"default",(function(){return s}));var s=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.apiHost=n.apiHost||"",this.searchRoute=n.searchRoute||"",this.limit=4,this.hintsOpen=!1,this.resultsItemClass=n.resultsItemClass||"",this.icons={0:"realEstate",135:"moto",508:"job",720:"animals",887:"flower",944:"antiques",968:"services",1003:"society",1023:"farming",1066:"machinery",1074:"kids",1085:"electronics",1127:"sport",1136:"maleFashion",1222:"fashion",1290:"science",1375:"accommodation"},this.numKeyups=0,this.timeout=null,this.inputPreventBlur=!1,this.hintsPreventBlur=!1,this.node=document.getElementById(e),this.el={input:document.getElementById(e+"Input"),btn:document.getElementById(e+"Button"),hints:document.getElementById(e+"Hints"),results:document.getElementById(e+"Results")},this.dynamicIndex=-1,this.results=null,this._mouseMoveLock=!1}var e,n,s;return e=t,(n=[{key:"init",value:function(){var t=this;this.el.input.addEventListener("keyup",(function(e){if(t.navigate(e),t.checkForDisabledKey(e))return!1;clearTimeout(t.timeout),27!==e.keyCode&&13!==e.keyCode&&(t.timeout=setTimeout((function(){return t.getSuggestions()}),500))})),this.el.input.addEventListener("keydown",(function(e){if(t.checkForDisabledKey(e))return!1;var n=e.target.value;13===e.keyCode&&n>=3&&t.chooseCategoryToSubmit(n),27===e.keyCode&&(t.hideHints(),t.dynamicIndex=-1)})),this.el.input.addEventListener("focus",(function(){t.dynamicIndex=-1,t.getSuggestions()})),this.el.input.addEventListener("mousedown",(function(){t.hintsPreventBlur=!0,t.inputPreventBlur=!1})),this.el.input.addEventListener("blur",(function(){if(t.inputPreventBlur)return t.inputPreventBlur=!1;t.hideHints()})),this.el.hints.addEventListener("mouseenter",(function(){var e=t.el.hints.getElementsByTagName("li");Array.from(e).forEach((function(n){n.addEventListener("mousemove",(function(){if(!t._mouseMoveLock){for(var i=0,s=e.length;i<s;i++)e[i].classList.remove("active");var r=n.getAttribute("data-index");t.dynamicIndex=r,e[t.dynamicIndex].classList.add("active")}t._mouseMoveLock=!0})),n.addEventListener("mouseleave",(function(){t._mouseMoveLock=!1}))}))})),this.node.addEventListener("submit",(function(e){e.preventDefault(),t.chooseCategoryToSubmit(t.el.input.value)}))}},{key:"chooseCategoryToSubmit",value:function(t){if(this.results&&this.hintsOpen&&this.dynamicIndex>=0){var e=Object.values(this.results[this.dynamicIndex]),n=e[e.length-1];this.searchPost(n.id,t)}else this.searchPost(0,t)}},{key:"navigate",value:function(t){var e=this.el.hints.getElementsByTagName("li");this.el.input.value.length>0&&e.length>0&&(this.dynamicIndex>=0&&e[this.dynamicIndex].classList.remove("active"),38===t.keyCode&&this.dynamicIndex>0?this.dynamicIndex--:40===t.keyCode&&this.dynamicIndex<e.length-1&&this.dynamicIndex++,e[this.dynamicIndex]&&(e[this.dynamicIndex].classList.add("active"),this._mouseMoveLock=!1))}},{key:"checkForDisabledKey",value:function(t){switch(t.keyCode){case 37:case 39:case 38:case 40:case 32:return!0;default:return!1}}},{key:"getSuggestions",value:function(){var t=this,e=this.el.input.value;if(e.length<3)return this.hideHints();var n="".concat(this.apiHost,"/suggestions/categories?phrase:all=").concat(e,"&limit=").concat(this.limit);fetch(n).then((function(n){if(200!==n.status)throw new Error("Status Code: ".concat(n.status));n.json().then((function(n){return t.updateHints(n.data,e)}))})).catch((function(t){throw new Error(t)}))}},{key:"showHints",value:function(){this.hintsOpen||(this.el.hints.style.display="block",this.hintsOpen=!0)}},{key:"hideHints",value:function(){this.hintsOpen&&(this.el.hints.style.display="none",this.el.results.innerHTML="",this.hintsOpen=!1,this.hintsPreventBlur=!1,this.inputPreventBlur=!1)}},{key:"updateHints",value:function(t,e){if(0===t.length)return this.hideHints();var n;for(n in this.results=t,this.showHints(),this.el.results.innerHTML="",t)t.hasOwnProperty(n)&&this.el.results.appendChild(this.prepareResultElement(t[n],e,n))}},{key:"prepareResultElement",value:function(t,e,n){var i=this,s=document.createElement("li"),r="".concat(this.resultsItemClass,"__result"),o="".concat(this.resultsItemClass,"__hint");return s.classList.add(r),s.classList.add("".concat(r,"--").concat(this.getIcons(t[0].id))),s.setAttribute("data-index",n),s.innerHTML=t.map((function(t){return'<span class="'.concat(o," ").concat(o,'--arrow">').concat(t.name,"</span>")})).join(""),s.addEventListener("mousedown",(function(){return i.searchPost(t[t.length-1].id,e)})),s}},{key:"getIcons",value:function(t){return t in this.icons?this.icons[t]:this.icons[0]}},{key:"searchPost",value:function(t,e){fetch(this.searchRoute,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({category:t,params:{q:e}})}).then((function(t){if(200!==t.status)throw new Error("Status Code: ".concat(t.status));t.text().then((function(t){return window.location.href=t}))})).catch((function(t){throw new Error(t)}))}}])&&i(e.prototype,n),s&&i(e,s),t}()}}).default}));